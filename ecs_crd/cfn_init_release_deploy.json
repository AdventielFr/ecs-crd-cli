{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "",
    "Parameters": {
        "ProjectName": {
            "Type": "String",
            "Description": "Project name.",
            "Default": ""
        },
        "HostedZoneName": {
            "Type": "String",
            "Description": "The ID of the hosted zone that contains the resource record sets that you want to change.",
            "Default": ""
        },
        "ClusterName": {
            "Type": "String",
            "Description": "Name of cluster used for deployment.",
            "Default": ""
        },
        "ServiceName": {
            "Type": "String",
            "Description": "Service name.",
            "Default": ""
        },
        "RetentionInDays": {
            "Type": "Number",
            "Description": "Cloud watch retention",
            "Default": 7
        },
        "LoadBalancerBlue": {
            "Type": "String",
            "Description": "The ARN of Blue load balancer.",
            "Default": ""
        },
        "LoadBalancerGreen": {
            "Type": "String",
            "Description": "The ARN of Green load balancer.",
            "Default": ""
        },
        "Region": {
            "Type": "String",
            "Description": "Amazon Web Services Region to deploy.",
            "Default": ""
        },
        "Environment": {
            "Type": "String",
            "Description": "Environment to deploy.",
            "Default": ""
        },
        "Route53RecordetSetTTL": {
            "Type": "Number",
            "Description": "TTL for Route53 recordset.",
            "Default": 60
        },
        "Fqdn":{
            "Type": "String",
            "Description": "FQDN of the service",
            "Default": ""
        }
    },
    "Resources": {
        "CloudWatchLogGroup": {
            "Type": "AWS::Logs::LogGroup",
            "Properties": {
                "LogGroupName": {
                    "Fn::Join": [
                        "",
                        [
                            "/aws/ecs/",
                            {
                                "Ref": "ClusterName"
                            },
                            "/service/",
                            {
                                "Ref": "ServiceName"
                            }
                        ]
                    ]
                },
                "RetentionInDays": {
                    "Ref": "RetentionInDays"
                }
            }
        },
        "CanaryReleaseRecordSetGroup": {
            "Type": "AWS::Route53::RecordSetGroup",
            "Properties": {
                "HostedZoneName": {
                    "Ref": "HostedZoneName"
                },
                "RecordSets": [{
                    "Name": {
                        "Ref": "Fqdn"
                    },
                    "Type": "CNAME",
                    "TTL": {
                        "Ref": "Route53RecordetSetTTL"
                    },
                    "SetIdentifier": "1",
                    "Weight": "100",
                    "ResourceRecords": [{
                        "Ref": "LoadBalancerGreen"
                    }]
                }, {
                    "Name": {
                        "Ref": "Fqdn"
                    },
                    "Type": "CNAME",
                    "TTL": {
                        "Ref": "Route53RecordetSetTTL"
                    },
                    "SetIdentifier": "2",
                    "Weight": "0",
                    "ResourceRecords": [{
                        "Ref": "LoadBalancerBlue"
                    }]
                }]
            }
        }
    }
}